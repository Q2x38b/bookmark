<!DOCTYPE html>
<html lang="en">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <meta name="description" content="BMarks is an ultra minimal bookmark keeper built for fast capture and recall." />
      <meta name="application-name" content="BMarks" />
      <meta name="theme-color" content="#141414" />
      <meta name="mobile-web-app-capable" content="yes" />
      <meta name="apple-mobile-web-app-capable" content="yes" />
      <meta name="apple-mobile-web-app-status-bar-style" content="black" />
      <title>BMarks ‚Äî ultra minimal bookmark keeper</title>
      <link rel="manifest" href="/manifest.webmanifest" />
      <link rel="icon" href="/icons/icon-32.png" sizes="32x32" type="image/png" />
      <link rel="icon" href="/icons/icon-96.png" sizes="96x96" type="image/png" />
      <link rel="apple-touch-icon" href="/icons/icon-192.png" />
      <link rel="stylesheet" href="styles/home.css" />
      <link rel="stylesheet" href="styles/main.css" />
    </head>
  <body data-view="loading">
    <section id="loadingView" class="loading-view">
      <div class="loading-inner">
        <span class="spinner"></span>
        <p>Checking your session‚Ä¶</p>
      </div>
    </section>

    <section id="landingView" class="landing-view" hidden>
      <div class="home-container">
        <header class="home-header">
          <div class="logo">
            <span class="logo-icon">üëã</span>
          </div>
          <a href="login.html" class="login-link">Login</a>
        </header>

        <main class="home-content">
          <h1 class="home-title">(Basic) Bookmarks</h1>
          <p class="home-description">
            A home for collecting and retrieving the most precious hyperlinks. You
            should probably be using something else, though.
          </p>

          <section class="home-section">
            <h2>About</h2>
            <p>
              Built for personal usage, designed with personal preferences. Bare-featured,
              <del>minimal</del> boring interface. Auto-detect input content type. Render
              links with page metadata. Keyboard-first design. Animated appropriately.
              Loads fast <em>(citation needed)</em>. No onboarding. No tracking. No ads, ever.
            </p>
          </section>

          <section class="home-section">
            <h2>Credits</h2>
            <p>
              Thank you to <a href="https://lanceross.xyz" target="_blank" rel="noopener">Lance</a> for designing the logomark, and
              <a href="https://pedro.to" target="_blank" rel="noopener">Pedro</a> for helping build
              the üß® <a href="https://www.raycast.com/extensions" target="_blank" rel="noopener">Raycast extension</a>.
            </p>
          </section>
        </main>

        <footer class="home-footer">
          <span class="version">v0.02</span>
          <span class="signature">‚úù</span>
        </footer>
      </div>
    </section>

    <section id="appView" class="app-view" hidden>
      <div class="container">
        <header class="app-header">
          <div class="header-left">
            <div class="logo">
              <span class="logo-icon">B</span>
              <span>Marks</span>
            </div>

            <div class="group-picker" data-open="false">
              <button class="group-picker-button" id="groupPickerButton" type="button">
                <span id="activeGroupLabel">All bookmarks</span>
                <svg width="14" height="14" viewBox="0 0 14 14">
                  <path
                    d="M3 5l4 4 4-4"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="1.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>

              <div class="group-dropdown" id="groupDropdown">
                <div id="groupOptions" class="group-options"></div>
                <div class="group-divider"></div>
                <div class="group-actions">
                  <button type="button" class="group-action-button" id="openGroupCreator">
                    + New group
                  </button>
                    <button type="button" class="group-action-button" id="openGroupEditor">
                      Edit group
                    </button>
                  <button type="button" class="group-action-button danger" id="openGroupDeleter">
                    Delete group
                  </button>
                </div>
                <form class="group-form" id="groupForm">
                  <div class="group-form-row">
                    <input
                      type="text"
                      id="groupNameInput"
                      name="groupName"
                      placeholder="Group name"
                      autocomplete="off"
                      required
                    />
                    <label class="group-color-picker" for="groupColorInput">
                      <span>Color</span>
                      <input
                        type="color"
                        id="groupColorInput"
                        name="groupColor"
                        value="#6366f1"
                        aria-label="Group color"
                      />
                    </label>
                  </div>
                  <button type="submit">Create</button>
                </form>
              </div>
            </div>
          </div>

          <div class="header-right">
            <button class="user-chip" id="userChip" type="button">
              <span class="user-avatar" id="userAvatar">?</span>
              <svg width="14" height="14" viewBox="0 0 14 14">
                <path
                  d="M3 5l4 4 4-4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>

            <div class="user-menu" id="userMenu" data-open="false">
              <div style="padding: 0.75rem; border-bottom: 1px solid var(--border-subtle);">
                <p
                  style="
                    font-family: var(--font-geist-mono);
                    font-size: 0.625rem;
                    color: var(--text-secondary);
                    margin-bottom: 0.25rem;
                  "
                >
                  SIGNED IN AS
                </p>
                <p
                  id="menuUserEmail"
                  style="font-family: var(--font-satoshi); font-size: 0.875rem; color: var(--text-primary);"
                >
                  ‚Äî
                </p>
              </div>
              <button type="button" class="user-menu-item" id="accountSettingsBtn">
                Account settings
              </button>
              <button type="button" class="user-menu-item" id="preferencesBtn">Preferences</button>
              <button type="button" class="user-menu-item" id="shortcutsBtn">
                Keyboard shortcuts
              </button>
              <button type="button" class="user-menu-item" id="docsBtn">Documentation</button>
              <hr />
              <button type="button" class="user-menu-item signout" id="signOutBtn">Sign out</button>
            </div>
          </div>
        </header>

        <div class="search-container">
          <div class="search-wrapper">
            <button
              class="add-bookmark-btn"
              id="openBookmarkModal"
              type="button"
              aria-label="Add bookmark"
            >
              <svg width="20" height="20" viewBox="0 0 20 20">
                <path
                  d="M10 4v12M4 10h12"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
              </svg>
            </button>
            <input
              id="searchInput"
              class="search-input"
              type="search"
              placeholder="Search bookmarks..."
              autocomplete="off"
            />
            <button
              class="clear-search-btn"
              id="clearSearchButton"
              type="button"
              aria-label="Clear search"
            >
              <svg width="16" height="16" viewBox="0 0 16 16">
                <path
                  d="M12 4L4 12M4 4l8 8"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                />
              </svg>
            </button>
          </div>
        </div>

        <section class="bookmarks-section">
          <div class="section-header">
            <span class="section-title">Title</span>
            <span class="section-title">Created</span>
          </div>
          <ul id="bookmarkList" class="bookmark-list" aria-live="polite">
            <li class="empty-state">
              <p>Loading bookmarks‚Ä¶</p>
            </li>
          </ul>
        </section>
      </div>
    </section>

    <div class="modal" id="bookmarkModal" aria-hidden="true">
      <div class="modal-content modal-simple">
        <div class="modal-header">
          <div>
            <h2 class="modal-title">Add bookmark</h2>
            <p class="modal-subtitle">Drop a link, color, or quick note.</p>
          </div>
          <button type="button" class="modal-close" data-close-modal aria-label="Close">
            <svg width="20" height="20" viewBox="0 0 20 20">
              <path d="M15 5L5 15M5 5l10 10" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
          </button>
        </div>

        <form id="bookmarkForm" class="modal-body simple-form">
          <div class="form-group">
            <label class="form-label" for="bookmarkContent">Content</label>
            <textarea
              id="bookmarkContent"
              class="form-textarea"
              name="content"
              rows="3"
              placeholder="Paste a link, #color, or text..."
              required
            ></textarea>
            <div class="form-inline-actions">
              <button type="button" class="ghost-chip" id="pasteBookmarkContent">Paste</button>
              <button type="button" class="ghost-chip tertiary" id="bookmarkFormReset">Clear</button>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label class="form-label" for="bookmarkTitle">Title (optional)</label>
              <input
                id="bookmarkTitle"
                class="form-input"
                name="title"
                placeholder="Auto-fills for links"
              />
            </div>
            <div class="form-group">
              <label class="form-label" for="bookmarkGroup">Group</label>
              <select id="bookmarkGroup" class="form-select" name="group">
                <option value="">No group</option>
              </select>
            </div>
          </div>

          <div class="modal-actions simple">
            <button type="submit" class="btn-primary" id="bookmarkSubmitButton">Save Bookmark</button>
            <button type="button" class="btn-danger is-hidden" id="deleteBookmarkButton">
              Delete Bookmark
            </button>
          </div>
        </form>
      </div>
    </div>

    <div class="modal" id="accountModal" aria-hidden="true">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">Account Settings</h2>
          <button type="button" class="modal-close" data-close-modal aria-label="Close">
            <svg width="20" height="20" viewBox="0 0 20 20">
              <path d="M15 5L5 15M5 5l10 10" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
          </button>
        </div>

        <form id="accountForm" class="modal-body">
          <div class="form-group">
            <label class="form-label" for="displayNameInput">Display Name</label>
            <input id="displayNameInput" class="form-input" name="displayName" />
          </div>

          <p
            id="accountInfo"
            style="
              font-family: var(--font-geist-mono);
              font-size: 0.75rem;
              color: var(--text-secondary);
              margin-bottom: 1rem;
            "
          ></p>

          <button type="submit" class="btn-primary">Save Changes</button>
        </form>
      </div>
    </div>

    <div class="modal" id="deleteGroupModal" aria-hidden="true">
      <div class="modal-content small">
        <div class="modal-header">
          <h2 class="modal-title">Delete group</h2>
          <button type="button" class="modal-close" data-close-modal aria-label="Close">
            <svg width="20" height="20" viewBox="0 0 20 20">
              <path d="M15 5L5 15M5 5l10 10" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <p>Bookmarks will keep their content but lose this label.</p>
          <p><strong id="groupDeleteName"></strong></p>
          <div class="modal-actions">
            <button type="button" class="btn-danger" id="confirmDeleteGroupButton">Delete group</button>
            <button type="button" class="btn-primary" data-close-modal>Cancel</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal" id="deleteBookmarkModal" aria-hidden="true">
      <div class="modal-content small">
        <div class="modal-header">
          <h2 class="modal-title">Delete bookmark</h2>
          <button type="button" class="modal-close" data-close-modal aria-label="Close">
            <svg width="20" height="20" viewBox="0 0 20 20">
              <path d="M15 5L5 15M5 5l10 10" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
          </button>
        </div>
        <div class="modal-body">
          <p>This removes the bookmark permanently.</p>
          <p><strong id="bookmarkDeleteName"></strong></p>
          <div class="modal-actions">
            <button type="button" class="btn-danger" id="confirmDeleteBookmarkButton">
              Delete bookmark
            </button>
            <button type="button" class="btn-primary" data-close-modal>Cancel</button>
          </div>
        </div>
      </div>
    </div>

      <div class="modal" id="editGroupModal" aria-hidden="true">
        <div class="modal-content small">
          <div class="modal-header">
            <h2 class="modal-title">Edit group</h2>
            <button type="button" class="modal-close" data-close-modal aria-label="Close">
              <svg width="20" height="20" viewBox="0 0 20 20">
                <path d="M15 5L5 15M5 5l10 10" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
              </svg>
            </button>
          </div>
          <form class="modal-body" id="groupEditForm">
            <div class="form-group">
              <label class="form-label" for="groupEditSelect">Select group</label>
              <select id="groupEditSelect" class="form-select" required></select>
            </div>
            <div class="form-group">
              <label class="form-label" for="groupEditNameInput">Group name</label>
              <input
                type="text"
                id="groupEditNameInput"
                class="form-input"
                name="groupEditName"
                placeholder="Group name"
                autocomplete="off"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label" for="groupEditColorInput">Group color</label>
              <div class="group-color-controls">
                <input
                  type="color"
                  id="groupEditColorInput"
                  name="groupEditColor"
                  value="#6366f1"
                  aria-label="Group color picker"
                />
                <button type="button" class="ghost-chip tertiary" id="randomizeGroupColorButton">Randomize</button>
              </div>
              <p class="form-hint">Pick a color to highlight this group.</p>
            </div>
            <div class="modal-actions simple">
              <button type="submit" class="btn-primary">Save changes</button>
              <button type="button" class="btn-danger" data-close-modal>Cancel</button>
            </div>
          </form>
        </div>
      </div>

      <div id="copyToast" class="toast" aria-live="polite"></div>

      <script src="js/config.js"></script>
      <script type="module" src="js/pwa.js"></script>
      <script type="module" src="js/app.js"></script>
    <script>
      (function scrubUrl() {
        if (!window.history?.replaceState) return;
        const { pathname, search, hash } = window.location;
        let newPath = pathname;
        if (pathname.endsWith(".html")) {
          newPath = pathname.replace(/index\.html$/i, "");
          if (newPath === pathname) {
            newPath = pathname.slice(0, -5);
          }
          if (!newPath) newPath = "/";
        }
        let newHash = hash;
        if (newHash === "#" || newHash === "#/") {
          newHash = "";
        }
        if (newPath !== pathname || newHash !== hash) {
          const next = `${newPath}${search}${newHash}`;
          window.history.replaceState({}, "", next);
        }
      })();
    </script>
  </body>
</html>
