<!DOCTYPE html>
<html lang="en">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <meta name="application-name" content="BMarks" />
      <meta name="theme-color" content="#141414" />
      <meta name="mobile-web-app-capable" content="yes" />
      <meta name="apple-mobile-web-app-capable" content="yes" />
      <meta name="apple-mobile-web-app-status-bar-style" content="black" />
      <title>BMarks — URL Parameters</title>
      <link rel="manifest" href="/manifest.webmanifest" />
      <link rel="icon" href="/icons/icon-32.png" sizes="32x32" type="image/png" />
      <link rel="icon" href="/icons/icon-96.png" sizes="96x96" type="image/png" />
      <link rel="apple-touch-icon" href="/icons/icon-192.png" />
      <link rel="stylesheet" href="/styles/home.css" />
    <style>
      body {
        max-width: 760px;
        margin: 0 auto;
        padding: 3rem 1.5rem 4rem;
        font-family: var(--font-geist-sans);
        color: var(--text-primary);
        background: var(--background);
        line-height: 1.6;
      }
      .docs-wrapper {
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }
      .docs-back {
        color: var(--text-secondary);
        text-decoration: none;
        font-family: var(--font-geist-mono);
        font-size: 0.8rem;
        letter-spacing: 0.08em;
      }
      .docs-back:hover {
        color: var(--text-primary);
      }
      .docs-hero h1 {
        font-size: clamp(2rem, 4vw, 2.4rem);
        margin: 0.25rem 0 0.5rem;
      }
      .docs-hero p {
        margin: 0;
        color: var(--text-secondary);
        max-width: 46rem;
      }
      .docs-eyebrow {
        font-family: var(--font-geist-mono);
        font-size: 0.72rem;
        letter-spacing: 0.2em;
        color: var(--text-secondary);
      }
        .docs-section {
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 14px;
        padding: 1.25rem 1.5rem;
        background: rgba(0, 0, 0, 0.2);
      }
        .docs-section + .docs-section {
        margin-top: 1rem;
      }
        .docs-steps {
          margin: 0 0 0.5rem 1.25rem;
          padding: 0;
          color: var(--text-secondary);
          line-height: 1.5;
        }
        .docs-steps li + li {
          margin-top: 0.35rem;
        }
      .docs-content h2 {
        margin: 0 0 0.75rem;
        font-size: 1rem;
        font-family: var(--font-geist-mono);
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: var(--text-secondary);
      }
      .docs-bullets {
        margin: 0;
        padding-left: 1rem;
        color: var(--text-secondary);
      }
      .docs-bullets li {
        margin-bottom: 0.4rem;
      }
      .docs-params {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin: 0;
      }
      .docs-params div {
        border-left: 2px solid rgba(255, 255, 255, 0.08);
        padding-left: 1rem;
      }
      .docs-params dt {
        margin: 0 0 0.35rem;
        display: flex;
        align-items: center;
        gap: 0.35rem;
        font-family: var(--font-geist-mono);
        font-size: 0.85rem;
      }
      .docs-params dt span {
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #f87171;
      }
      .docs-params dd {
        margin: 0;
        color: var(--text-secondary);
      }
      code {
        font-family: var(--font-geist-mono);
        font-size: 0.85rem;
        background: rgba(255, 255, 255, 0.08);
        padding: 0.15rem 0.4rem;
        border-radius: 6px;
      }
      pre {
        margin: 0;
        border-radius: 12px;
        padding: 0.85rem 1rem;
        background: rgba(7, 7, 7, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.06);
        font-family: var(--font-geist-mono);
        font-size: 0.85rem;
        overflow-x: auto;
      }
      @media (max-width: 640px) {
        body {
          padding: 2.25rem 1.25rem 3rem;
        }
        .docs-content section {
          padding: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <main class="docs-wrapper">
      <a href="/" class="docs-back">← Back</a>
        <header class="docs-hero">
          <p class="docs-eyebrow">Documentation</p>
          <h1>BMarks usage guide</h1>
          <p>
            Capture links, colors, notes, and now images, with live sync across every signed-in browser or device. Keep this
            page handy for automations, drag-and-drop tips, and storage configuration.
          </p>
        </header>

        <article class="docs-content">
          <section class="docs-section">
            <h2>Quick start</h2>
            <ul class="docs-bullets">
              <li>Sign in with your Supabase project credentials and start adding groups; they appear instantly on other tabs.</li>
              <li>Keyboard friendly: <code>⌘K</code>/<code>Ctrl+K</code> to focus search, arrows to move, <code>⏎</code> to copy or open.</li>
              <li>No manual refresh—bookmarks and groups stream over Supabase Realtime across browsers and devices.</li>
            </ul>
          </section>

          <section class="docs-section">
            <h2>Capture options</h2>
            <ul class="docs-bullets">
              <li><strong>Drag anything.</strong> Drop text or a URL anywhere on the app to open the modal with the content pre-filled.</li>
              <li><strong>Image attachments.</strong> Use the Media field or drop an image to upload it to Supabase Storage, auto-generate an average-color icon, and store an optional note.</li>
              <li><strong>Clipboard + share targets.</strong> Use the Paste button, the PWA share target, or scripted calls to the root URL with query parameters.</li>
              <li><strong>Color + link detection.</strong> Hex values, rgb()/hsl(), and bare domains are auto-classified without extra input.</li>
            </ul>
          </section>

          <section class="docs-section">
            <h2>URL parameters</h2>
            <p>Send a GET request to <code>/</code> with any of the following:</p>
            <dl class="docs-params">
              <div>
                <dt><code>content</code> <span>required</span></dt>
                <dd>Any link, hex/rgb color, or text snippet. Detection runs automatically.</dd>
              </div>
              <div>
                <dt><code>title</code></dt>
                <dd>Optional override. Links fetch their own title; text requires one.</dd>
              </div>
              <div>
                <dt><code>group</code></dt>
                <dd>Group UUID or case-insensitive name. Ignored when it does not exist.</dd>
              </div>
              <div>
                <dt><code>url</code> / <code>text</code></dt>
                <dd>Share target compatible; falls back to <code>content</code> if both are present.</dd>
              </div>
              <div>
                <dt><code>new</code></dt>
                <dd>Use <code>new=1</code> to force the modal to open even without payload.</dd>
              </div>
            </dl>
            <pre>/?content=https://example.com/docs&title=Docs&group=Design
/?content=%23ffcc00&group=Palette
/?text=Remember+this&new=1</pre>
          </section>

          <section class="docs-section">
            <h2>Image storage setup (Supabase)</h2>
            <p>
              Image attachments live in a Storage bucket named <code>bookmark-images</code>. Create it once in your Supabase
              dashboard:
            </p>
            <ol class="docs-steps">
              <li>Open <strong>Storage → Buckets</strong>, create <code>bookmark-images</code>, and set it to <em>Public</em> (or supply a signed URL proxy).</li>
              <li>
                In <strong>Policies</strong>, allow authenticated inserts and selects—for example:
                <pre>create policy "allow authenticated uploads"
on storage.objects for insert
with check (bucket_id = 'bookmark-images' and auth.role() = 'authenticated');</pre>
              </li>
              <li>Repeat for <code>select</code>/<code>update</code> if you want users to replace attachments.</li>
              <li>No code changes are required after the bucket exists; uploads happen from the Media field during bookmark save.</li>
            </ol>
            <p>
              Each bookmark stores the public URL plus the average color, dimensions, and optional note inside <code>metadata</code> and <code>text_note</code>.
            </p>
          </section>

          <section class="docs-section">
            <h2>Realtime sync</h2>
            <ul class="docs-bullets">
              <li>Supabase Realtime channels push bookmark and group updates instantly—no 30-second polling loop.</li>
              <li>Offline tabs replay pending changes as soon as they regain focus or connectivity.</li>
              <li>Local BroadcastChannel keeps multiple tabs on the same device aligned without hitting the network.</li>
            </ul>
          </section>
        </article>
    </main>
      <script type="module" src="/js/pwa.js"></script>
    </body>
</html>

